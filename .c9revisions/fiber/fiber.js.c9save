{"ts":1341507406662,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1341507413301,"patch":[[{"diffs":[[1,"$(function() {\r\nvar d=[];\r\nvar url = \"http://services.massdot.state.ma.us/ArcGIS/rest/services/Assets/FiberOpticLines/MapServer/0/query?outFields=*&f=json&outSR=4326&where=OBJECTID+%3E+0\";\r\nvar g =google.maps;\r\nvar center = new g.LatLng(41.914541,-71.592407);\r\nvar zoom = 8;\r\nvar infowindow = new g.InfoWindow();\r\nvar stati=[\"Existing\",\"Proposed\",\"Gap\"];\r\nvar m = new g.Map(document.getElementById('map'), {\r\n      center: center,\r\n      zoom: zoom,\r\n      mapTypeId: 'roadmap'\r\n    });\r\n    \r\n \r\n\r\n    $.get(url,data,\"jsonp\"\r\n    );\r\n\r\nfunction data(e){\r\n   $.each(e.features,parseFt);\r\n}\r\n$( \"#tabs\" ).tabs({\r\n    collapsible: true,\r\n    selected: -1\r\n});\r\n          \r\n$( \"input:submit,input:reset\" ).button();\r\n\r\n$('input, textarea').placeholder();\r\nfunction parseFt(i,v){\r\n    var ft = {id:i,\r\n    name:v.attributes.Route,\r\n    status:v.attributes.Status};\r\n    var path = $.map(v.geometry.paths[0],mapLL);\r\n    //if you have a feature with multipart lines ^^ won't work\r\n    var lineSymbol = {\r\n  path: 'M 0,-1 0,1',\r\n  strokeOpacity: 1,\r\n  scale: 4\r\n};\r\n    ft.line = new g.Polyline({path:path,map:m,strokeOpacity: 0,\r\n  icons: [{\r\n    icon: lineSymbol,\r\n    offset: '0',\r\n    repeat: '20px'\r\n  }],});\r\n    g.event.addListener(ft.line, 'click', iw);\r\n    function iw(event){\r\n    infowindow.setContent(\"<div class='iw'>\"+ft.name+\" which is \"+ft.status+\"</div>\");\r\n  infowindow.setPosition(event.latLng);\r\n\r\n  infowindow.open(m);\r\n}\r\nd.push(ft);\r\n}\r\nfunction mapLL(v){return new g.LatLng(v[1],v[0]);}\r\ngeocoder();\r\nfunction geocoder(geof,addrf,resetf){\r\n    var ozoom = m.getZoom();\r\n    var ocenter = m.getCenter();\r\n    var gc = new g.Geocoder();\r\n    geof = geof||'geocode';\r\n    addrf = addrf||'address';\r\n    resetf = resetf||'resetgeo';\r\n    gc.geomarker = new g.Marker();\r\n    var geoinfo = new g.InfoWindow();\r\n    $('#' + geof).click(function(){\r\n        gc.geocode( { 'address': $(\"#\" + addrf).val()}, function(results, status) {\r\n            if (status == g.GeocoderStatus.OK) {\r\n                var r = results[0];\r\n                m.setCenter(r.geometry.location);\r\n                m.setZoom(14);\r\n                gc.geomarker.content = \"<div class='geoinfo'>Formatted address:<br/>\"+r.formatted_address+\"</div>\";\r\n                gc.geomarker.setPosition(r.geometry.location); \r\n                gc.geomarker.setMap(m);\r\n                g.event.addListener(gc.geomarker, 'click',function(){\r\n                                geoinfo.setContent(gc.geomarker.content);\r\n                              geoinfo.open(m,gc.geomarker);\r\n                \t\t\t});\r\n            } else {\r\n                alert(\"Geocode was not successful for the following reason: \" + status);\r\n            }\r\n        });\r\n    });\r\n\r\n    $('#' + resetf).click(function(){\r\n        m.setCenter(ocenter);\r\n        m.setZoom(ozoom);\r\n        gc.geomarker.setMap(null);\r\n    });\r\n};\r\n$('#tabs-2').append('<select id=\"stat\"><option value=\"all\">Choose Status</option></select>');\r\n\r\n$.each(stati,function(i,k){\r\n    $('#stat').append(\"<option value='\" +k+\"'>\"+k+\"</option>\");\r\n});\r\n$('#stat').change(function(){\r\n    var val = $('#stat').val();\r\n    if(val==='all'){\r\n        $.each(d,function(i,v){\r\n            v.line.setMap(m);\r\n        });\r\n}else {\r\n    $.each(d,function(i,v){\r\n        if(v.status===val){\r\n            v.line.setMap(m);\r\n        }else{  v.line.setMap(null);\r\n        }\r\n        });\r\n}\r\n    \r\n    });\r\n});\r\n"]],"start1":0,"start2":0,"length1":0,"length2":3409}]],"length":3409,"saved":false}
