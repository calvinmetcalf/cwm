{"ts":1342110594883,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var d= new L.LayerGroup();\nvar center = new L.LatLng(42.3584308,-71.0597732);\nvar zoom = 14;\nvar t={\n    url: \"http://{s}.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.png\",\n    options:{\n        attribution:\"Tiles from Mapquest\",\n        subdomains:[\"otile1\",\"otile2\",\"otile3\",\"otile4\"],\n        attribution:\"Tiles from Mapquest, Tile data from Open Street Map\"\n    },\n};\n\nt.o = new L.TileLayer(t.url,t.options);\n\n\nvar m = new L.Map('map',{\n    center:center,\n    zoom:zoom,\n    layers:[t.o]\n    });\nvar gj =  new L.GeoJSON();\nvar d;\nm.addLayer(gj);\ngj.on(\"featureparse\", function (e) {\n    if (e.properties){\n        e.layer.bindPopup(makePop(e.properties));\n    }\n});\nvar bbox=m.getBounds().toBBoxString();\n  $.get(\"http://services.massdot.state.ma.us/ArcGIS/rest/services/Assets/SmartCameras/MapServer/0/query?outFields=*&f=json&outSR=4326&inSR=4326&geometryType=esriGeometryEnvelope&geometry=\"+bbox,parseJSONP,\"JSONP\");\nfunction parseJSONP(data){\nd=toJSON(data);\ngj.addGeoJSON(d);\n};\nfunction reparseJSONP(data){\ngj.clearLayers()\nd=toJSON(data);\ngj.addGeoJSON(d);\n};\nm.on(\"dragend\",redo)\nm.on(\"zoomend\",redo)\nfunction redo(){\nbbox=m.getBounds().toBBoxString();\ngj.clearLayers()\n$.get(\"http://services.massdot.state.ma.us/ArcGIS/rest/services/Assets/SmartCameras/MapServer/0/query?outFields=*&f=json&outSR=4326&inSR=4326&geometryType=esriGeometryEnvelope&geometry=\"+bbox,reparseJSONP,\"JSONP\");\n}\nfunction makePop(p){\nvar a = [];\n for(var key in p){\n     a.push(key+\": \"+p[key]);\n }\n return a.join(\"<br/>\");\n}\nfunction toJSON(esri){\n    var geo = {\"type\": \"FeatureCollection\", \"features\":[]};\n    $.each(esri.features,function(i,v){\n        var ft = {\"type\": \"Feature\", \"id\":i}\n        ft.geometry={\"type\":\"Point\",\"coordinates\":[v.geometry.x,v.geometry.y]}\n        ft.properties=v.attributes;\n        geo.features.push(ft)\n    });\n    return geo;\n    \n}"]],"start1":0,"start2":0,"length1":0,"length2":1848}]],"length":1848}
